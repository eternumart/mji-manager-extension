/******/ (() => { // webpackBootstrap
/******/ 	"use strict";

// UNUSED EXPORTS: baseUrl

;// ./src/apiConfig.ts
const apiConfig={address:{protocol:"http://",ip:"mjimanager.ru",devPort:3000,prodPort:80},routes:{pages:{home:"/",registration:"registration",login:"login",profile:"profile",defectEditor:"defect-editor"},api:{registration:"/auth/registration",login:"/auth/login",activation:"/auth/activation",getApp:"/api/get-app",userData:"/api/userdata",allUsersData:"/api/allusersdata",saveDefects:"/api/save-defects",saveFio:"/api/savefio",activeFunctions:"/api/change-functions",changeUserPermissions:"/api/change-permissions",changeAccount:"/api/change-account",deactivateAccount:"/api/deactivate-account",getAppData:"/api/get-app-data",checkResponseFromServer:"/api/check-response-from-server",getScripts:"/api/get-scripts",uploadPDF:"/api/upload-pdf",rephraseDefectsBlock:"/api/rephrase-defects-block"}}};
;// ./src/components/Extention/utils/decodeToken.ts
/**
 * üî• –§—É–Ω–∫—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è JWT-—Ç–æ–∫–µ–Ω–∞
 * @param token - JWT-—Ç–æ–∫–µ–Ω
 * @returns –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω–∞ –∏–ª–∏ `null`, –µ—Å–ª–∏ –æ—à–∏–±–∫–∞
 */function decodeToken(token){try{if(!token||typeof token!=="string"){console.warn("‚ùå –ü—É—Å—Ç–æ–π –∏–ª–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–æ–∫–µ–Ω");return null;}const base64Payload=token.split(".")[1];if(!base64Payload)throw new Error("‚ùå –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ç–æ–∫–µ–Ω–∞");// ‚úÖ –ò—Å–ø—Ä–∞–≤–ª—è–µ–º `Base64` (–∑–∞–º–µ–Ω—è–µ–º `-` –Ω–∞ `+` –∏ `_` –Ω–∞ `/`)
const decodedPayload=decodeURIComponent(escape(atob(base64Payload.replace(/-/g,"+").replace(/_/g,"/"))));return JSON.parse(decodedPayload);}catch(error){console.error("‚ùå –û—à–∏–±–∫–∞ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–∞:",error);return null;}}
;// ./src/components/Extention/utils/messageUtils.ts
/**
 * –°–ª—É—à–∞–µ—Ç –æ—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ PDF. –î–∞–Ω–Ω—ã–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –æ—Ç –±—ç–∫–µ–Ω–¥–∞:
 * –±—ç–∫–µ–Ω–¥ –æ—Ç–¥–∞—ë—Ç –∫—É—Å–∫–∏ —Ñ–∞–π–ª–∞ –≤ DeepSeek, –ø–∞—Ä—Å–∏–Ω–≥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ DeepSeek, –Ω–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ.
 */function pdfParserListener(){chrome.runtime.onMessage.addListener((message,sender,sendResponse)=>{if(message.type==="UPLOAD_COMPLETE"){console.log("–†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ DeepSeek (PDF):",message.data);chrome.tabs.query({active:true,currentWindow:true},tabs=>{const tab=tabs[0];if(tab&&tab.id!==undefined){chrome.scripting.executeScript({target:{tabId:tab.id},func:sendDataToPopup,args:[message.data]});}else{console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É –∏–ª–∏ –ø–æ–ª—É—á–∏—Ç—å tabId.");}});}});}/** –ü–µ—Ä–µ–¥–∞—ë—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ DeepSeek –≤ –ø–æ–ø–∞–ø: —Å–æ—Ö—Ä–∞–Ω—è–µ–º, –≤—ã–∑—ã–≤–∞–µ–º –≤—Å—Ç–∞–≤–∫—É (MJIDATA + loadData), —Å–∫—Ä—ã–≤–∞–µ–º –ª–æ–∞–¥–µ—Ä. */function sendDataToPopup(data){console.log("–†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ PDF (DeepSeek):",data);localStorage.setItem("parsedPDF",JSON.stringify(data));if(window.appVariables&&window.appVariables.loaderPDF){window.appVariables.loaderPDF.style.display="none";}if(typeof window.handleParsedPdfResult==="function"){window.handleParsedPdfResult(data);}}
;// ./src/chromeServices/DOMEvaluator.ts
console.log("DOMEvaluator.ts loaded");let baseUrl=`${apiConfig.address.protocol}${apiConfig.address.ip}`;// –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã–±—Ä–∞–Ω —Å–µ—Ä–≤–µ—Ä Prod
const loadingFlags=new Map();// –û–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ background: –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –Ω–∞ UPLOAD_COMPLETE –∏ –ø–µ—Ä–µ–¥–∞—ë–º –¥–∞–Ω–Ω—ã–µ –≤ –∏–Ω–∂–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø–∞–Ω–µ–ª—å
pdfParserListener();chrome.runtime.onMessage.addListener(async(message,sender,sendResponse)=>{if(message.type==="REPHRASE_DEFECTS_BLOCK"){try{const response=await fetch(`${baseUrl}${apiConfig.routes.api.rephraseDefectsBlock}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({results:message.results})});const result=await response.json();chrome.runtime.sendMessage({type:"REPHRASE_DEFECTS_BLOCK_RESPONSE",data:result.success?result.data:null,error:result.error||null});}catch(error){chrome.runtime.sendMessage({type:"REPHRASE_DEFECTS_BLOCK_RESPONSE",data:null,error:error.message});}return;}// –ó–∞–≥—Ä—É–∑–∫–∞ PDF –Ω–∞ –±—ç–∫–µ–Ω–¥: –ø–∞—Ä—Å–∏–Ω–≥ —Ç–æ–ª—å–∫–æ –≤ DeepSeek. –ë—ç–∫–µ–Ω–¥ –æ—Ç–¥–∞—ë—Ç –∫—É—Å–∫–∏ —Ñ–∞–π–ª–∞ –Ω–∞ –∞–Ω–∞–ª–∏–∑, –Ω–µ –ø–∞—Ä—Å–∏—Ç –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ.
if(message.type==="UPLOAD_PDF"){try{console.log(`PDF –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤ DeepSeek: ${message.fileName}`);if(message.useAI){console.log("–í–∫–ª—é—á–µ–Ω–æ –ø–µ—Ä–µ—Ñ—Ä–∞–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ—Ñ–µ–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ AI");}const fileBase64=message.fileData;const payload={fileName:message.fileName,fileData:fileBase64,useAI:message.useAI,prevSurveyNumber:message.prevSurveyNumber,address:message.address||""};const response=await fetch(`${baseUrl}${apiConfig.routes.api.uploadPDF}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(payload)});const result=await response.json();chrome.runtime.sendMessage({type:"UPLOAD_COMPLETE",data:result});}catch(error){console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ PDF:",error);chrome.runtime.sendMessage({type:"UPLOAD_FAILED",error:error.message});}}});chrome.runtime.onMessage.addListener(async(request,sender,sendResponse)=>{switch(request.contentScriptQuery){case"activate-request":{if(!request.data.login||!request.data.password||!request.data.key){console.error("‚ùå –ü–æ–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã!");return;}console.log("üì© –ó–∞–ø—Ä–æ—Å –Ω–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏—é –ø–æ–ª—É—á–µ–Ω:",request.data);activation(request);break;}case"logIn-request":{login(request).then(response=>{console.log("‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º logIn-response...");const decoded=decodeToken(response.accessToken);if(decoded){response.fio=decoded.fio;response.login=decoded.login;}console.log("decoded token: ",decoded.fio,decoded.login);chrome.runtime.sendMessage({contentScriptQuery:"logIn-response",data:[response,decoded.login]});chrome.runtime.sendMessage({contentScriptQuery:"userData-response",data:[response,decoded.login]});});return;}case"savefio-request":{saveFio(request);console.log("savefio-request");break;}case"appData-request":{appData(request.data);break;}case"enviromentSwitch-request":{console.log(`üõ† –ó–∞–ø—Ä–æ—Å—ã –ø–æ–π–¥—É—Ç –Ω–∞ ${request.enviroment} —Å–µ—Ä–≤–µ—Ä.`);baseUrl=request.baseUrl;checkResponseFromServer(request);break;}case"app-loaded-response":{baseUrl=request.baseUrl;break;}case"enviroment-check-request":{console.log("enviroment-check-request");getCurrentEnviroment();break;}case"logOut-request":{console.log("üî¥ –ü–æ–ª—É—á–µ–Ω –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã—Ö–æ–¥");chrome.storage.local.clear(()=>{console.log("‚úÖ –ö–µ—à –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–µ–Ω.");});sendResponse({success:true});return true;}}});async function fetchWithRetry(url,options){let retries=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;let useCache=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(loadingFlags.get(url)){return;}loadingFlags.set(url,true);for(let i=0;i<retries;i++){try{console.info(`‚è≥ –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É ‚Ññ${i+1} –ø–æ URL ${url}`);const controller=new AbortController();const timeout=setTimeout(()=>controller.abort(),5000);// ‚è≥ 5 —Å–µ–∫—É–Ω–¥
const response=await fetch(url,{...options,signal:controller.signal});clearTimeout(timeout);if(!response.ok){chrome.runtime.sendMessage({contentScriptQuery:"Error-response",error:`‚ùå –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –°—Ç–∞—Ç—É—Å: ${response.status}`});loadingFlags.set(url,false);throw new Error(`HTTP error! status: ${response.status}`);}const data=await response.json();loadingFlags.set(url,false);if(retries===3){console.log("4! üì¶ –°–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.");}if(retries===5){console.log("9! üì¶ –°–µ—Ä–≤–µ—Ä –ø—Ä–∏—Å–ª–∞–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.",data);}return data;}catch(error){chrome.runtime.sendMessage({contentScriptQuery:"Error-response",error:`‚ö†Ô∏è –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ #${i+1} –∏–∑ ${retries} –Ω–µ —É–¥–∞–ª–∞—Å—å. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞`});if(i===retries-1){if(useCache){const cachedData=await new Promise(resolve=>{chrome.storage.local.get([url],result=>{resolve(result[url]||null);});});if(cachedData){loadingFlags.set(url,false);chrome.runtime.sendMessage({contentScriptQuery:"Error-response",error:"‚ö†Ô∏è –í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É –ø—Ä–æ–≤–∞–ª–∏–ª–∏—Å—å, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"});return cachedData;}chrome.runtime.sendMessage({contentScriptQuery:"Error-response",error:"‚ùå –í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É –ø—Ä–æ–≤–∞–ª–∏–ª–∏—Å—å. –î–∞–Ω–Ω—ã–µ –≤ –∫–µ—à–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç."});}else{chrome.runtime.sendMessage({contentScriptQuery:"Error-response",error:"‚ùå –í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É –ø—Ä–æ–≤–∞–ª–∏–ª–∏—Å—å."});}}}}}async function getCurrentEnviroment(){chrome.runtime.sendMessage({contentScriptQuery:"enviroment-check-response",enviroment:baseUrl});}async function checkResponseFromServer(request){console.log("‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞ DOMEvaluator.ts");try{const url=`${baseUrl}${apiConfig.routes.api.checkResponseFromServer}`;// –í—ã–ø–æ–ª–Ω—è–µ–º –∑–∞–ø—Ä–æ—Å –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ–ª–∞–≥–æ–≤ –∑–∞–≥—Ä—É–∑–∫–∏
await fetchWithRetry(url,{method:"GET",headers:{"Content-Type":"application/json"}}).then(res=>{console.log(`üü¢ –°–µ—Ä–≤–µ—Ä ${request.enviroment} –¥–æ—Å—Ç—É–ø–µ–Ω`);baseUrl=request.baseUrl;});}catch(error){console.error(`üî¥ –°–µ—Ä–≤–µ—Ä ${request.enviroment} –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω`,error);}}async function activation(request){console.log("‚è≥ –ù–∞—á–∞—Ç –ø—Ä–æ—Ü–µ—Å—Å –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ...");const url=`${baseUrl}${apiConfig.routes.api.activation}`;try{// ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
const data=await fetchWithRetry(url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({login:request.data.login,password:request.data.password,key:request.data.key})});console.log("‚úÖ –°–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª –¥–∞–Ω–Ω—ã–µ –ø–æ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:",data);// ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞—Ç–Ω–æ –≤ `activateForm.tsx`
chrome.runtime.sendMessage({contentScriptQuery:"activate-response",// üî• –ó–¥–µ—Å—å –±—ã–ª–æ "activation-response"
data});}catch(error){console.error("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:",error);chrome.runtime.sendMessage({contentScriptQuery:"activate-response",error:"‚ùå –û—à–∏–±–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ."});}}async function login(request){const url=`${baseUrl}${apiConfig.routes.api.login}`;try{const data=await fetchWithRetry(url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:request.data})},3,// 3 –ø–æ–ø—ã—Ç–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É
true);return data;}catch(error){chrome.runtime.sendMessage({contentScriptQuery:"Error-response",error:error,flow:"logIn"});return{success:false,error:error};}}async function saveFio(request){const url=`${baseUrl}${apiConfig.routes.api.saveFio}`;try{const data=await fetchWithRetry(url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:request.data})});chrome.runtime.sendMessage({data,contentScriptQuery:"savefio-response"});}catch(error){chrome.runtime.sendMessage({contentScriptQuery:"Error-response",error:error,flow:"savefio"});}}async function appData(request){console.log("8! ‚è≥ –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞–ø—Ä—è–º—É—é —Å —Å–µ—Ä–≤–µ—Ä–∞.");const url=`${baseUrl}${apiConfig.routes.api.getAppData}`;try{// ‚úÖ –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º `appData` —Å —Å–µ—Ä–≤–µ—Ä–∞
const data=await fetchWithRetry(url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:request.data})},5,// 5 –ø–æ–ø—ã—Ç–æ–∫ –∑–∞–ø—Ä–æ—Å–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É
true);console.log("10! ‚úÖ –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω—ã —Å —Å–µ—Ä–≤–µ—Ä–∞:",data);chrome.runtime.sendMessage({contentScriptQuery:"appData-response",data:data,baseUrl:baseUrl});}catch(error){console.warn("‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ `appData`, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º `empty` –≤ `appData-response`...");chrome.runtime.sendMessage({contentScriptQuery:"appData-response",data:"empty",baseUrl:baseUrl});}}
/******/ })()
;